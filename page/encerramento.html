<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema PMP/PMAL | ENCERRAMENTO</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="css/stylesindex.css">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/encerramento.css">
    <link rel="stylesheet" href="css/certidao.css">


    <link rel="shortcut icon" href="img/favicon.ico" type="image/x-icon">

    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
</head>

<body>
    <header>
        <section class="cabecalho-geral"
            style="display: flex; justify-content: space-between; align-items: center; width: 100%;">
            <div class="header-info-left">
                <img class="brasao" src="img/brasao.png" alt="brasao">
                <div class="cabecalho">
                    <h1>CENTRAL DE MONITORAMENTO ÍRIS</h1>
                    <h3>POLÍCIA MILITAR DE ALAGOAS</h3>
                    <h3>CENTRAL DE OPERAÇÕES DA POLÍCIA MILITAR - COPOM</h3>
                    <h3 id="unidade">--</h3>
                </div>
            </div>
            <div class="header-info-right" style="text-align: right; padding-right: 50px;">
                <div style="color: blueviolet; font-weight: bold;"><i class="fas fa-user-shield"></i> Operador: <span
                        id="nome-operador">---</span></div>
                <div id="relogio" style="color: #555; font-weight: bold; font-size: 1.1rem;"><span
                        id="current-date-time"></span></div>
            </div>
        </section>
    </header>
    <section class="pagecomplete">
        <nav class="navegacao">
            <div class="nav-links">
                <a href="index.html">
                    <img width="30" height="30" src="https://img.icons8.com/material-outlined/24/home--v2.png"
                        alt="home" />
                    <p>Home</p>
                </a>
                <a href="fiscalizacaohome.html" class="active">
                    <img width="30" height="30" src="https://img.icons8.com/ios-filled/50/policeman-female.png"
                        alt="policeman-female" />
                    <p>Fiscalização</p>
                </a>
            </div>

            <a href="javascript:void(0)" onclick="logout()"
                style="color: #d9534f; border-top: 1px solid #eee; padding-top: 15px;">
                <i class="fas fa-sign-out-alt" style="font-size: 24px;"></i>
                <p>Sair</p>
            </a>
        </nav>

        <div class="container-tabela">
            <div class="header-tabela">
                <h2 style="color: blueviolet;"><i style="color: blueviolet;" class="fas fa-file-invoice"></i> Termos de
                    Encerramento</h2>
                <button class="btn-adicionar" onclick="abrirSidebarCertidao()">
                    <i class="fas fa-plus"></i> Novo Termo de Encerramento
                </button>
            </div>
            <div class="barra-filtros">
                <div style="flex: 1; min-width: 200px;">
                    <input class="filtro" type="text" id="filtro-nome" placeholder="Filtrar por Assistida..."
                        onkeyup="filtrarTabela()">
                </div>
                <input class="filtrodata" type="date" id="filtro-data" onchange="filtrarTabela()">
                <button class="btn-adicionar" onclick="abrirModalRelatorio()"
                    style="background-color: #2c3e50; margin-left: auto;">
                    <i class="fas fa-print"></i> Relatório Mensal
                </button>
            </div>

            <div id="modal-relatorio" class="sidebar-cadastro"
                style="display:none; background: rgba(0,0,0,0.5); width: 100%; height: 100%; justify-content: center; align-items: center;">
                <div style="background: white; padding: 30px; border-radius: 8px; width: 400px; position: relative;">
                    <h3>Gerar Relatório Mensal</h3>
                    <br>
                    <label>Data Início:</label>
                    <input type="date" id="rel-inicio" class="grupo-input" style="width: 100%; margin-bottom: 10px;">
                    <label>Data Fim:</label>
                    <input type="date" id="rel-fim" class="grupo-input" style="width: 100%; margin-bottom: 10px;">
                    <label>Vara:</label>
                    <input type="text" id="rel-vara" placeholder="Ex: 1ª VARA"
                        style="width: 100%; margin-bottom: 20px; padding: 8px;">

                    <div style="display: flex; gap: 10px;">
                        <button onclick="gerarRelatorioMensal()" class="btn-salvar">Gerar Relatório</button>
                        <button onclick="fecharModalRelatorio()"
                            style="background:#666; color:white; border:none; padding:10px; border-radius:4px; cursor:pointer;">Cancelar</button>
                    </div>
                </div>
            </div>
            <div class="tabela-wrapper">
                <table class="tabela-assistidas">
                    <thead>
                        <tr>
                            <th>DATA</th>
                            <th>REPRESENTANTE</th>
                            <th>MPU</th>
                            <th>Nº DO BOU</th>
                            <th>DATA DO ENCERRAMENTO</th>
                            <th>MOTIVO</th>
                            <th>JUSTIFICATIVA</th>
                            <th style="text-align: center;">AÇÕES</th>
                        </tr>
                    </thead>
                    <tbody id="corpo-tabela-certidoes">
                    </tbody>
                </table>
            </div>
        </div>

        <div id="sidebarCertidao" class="sidebar-certidao">
            <div class="sidebar-content">
                <div class="sidebar-header">
                    <h2 id="titulo-sidebar">Nova Certidão</h2>
                    <button onclick="fecharSidebarCertidao()" class="btn-fechar-sidebar">&times;</button>
                </div>

                <form id="form-certidao">
                    <input type="hidden" id="ID">
                    <div class="grupo-input">
                        <label>Data</label>
                        <input type="date" id="DATA" required>
                    </div>

                    <div class="grupo-input">
                        <label for="NOME">NOME DA REPRESENTANTE:</label>
                        <select name="NOME" id="NOME" required>
                            <option value="">Carregando assistidas...</option>
                        </select>
                    </div>

                    <div class="row-form" style="display:flex; gap:10px;">
                        <div class="grupo-input" style="flex:1;">
                            <label>NOME DO REPRESENTADO</label>
                            <input type="text" id="NOME_DO_REPRESENTADO">
                        </div>
                        <div class="grupo-input" style="flex:1;">
                            <label>MPU</label>
                            <input type="text" id="MPU">
                        </div>
                    </div>

                    <div class="row-form" style="display:flex; gap:10px;">
                        <div class="grupo-input" style="flex:1;">
                            <label>CMMT DA GUARNIÇÃ</label>
                            <input type="text" id="CMT_DA_GUARNICAO">
                        </div>
                        <div class="grupo-input" style="flex:1;">
                            <label>DATA</label>
                            <input type="date" id="DATA">
                        </div>
                    </div>

                    <div class="grupo-input">
                        <label>Nº DO BOU</label>
                        <input type="text" id="NUMERO_BOU">
                    </div>

                    <div class="row-form" style="display:flex; gap:10px;">
                        <div class="grupo-input" style="flex:1;">
                            <label>MOTIVO DO ENCERRAMENTO</label>
                            <select name="MOTIVO_ENCERRAMENTO" id="MOTIVO_ENCERRAMENTO">
                                <option value="">Selecione o Motivo</option>
                                <option value="Medida Protetiva de Urgência expirou na data de ">Medida Protetiva de
                                    Urgência expirou na data de </option>
                                <option value="A vítima pediu desistência da MPU">A vítima pediu desistência da MPU
                                </option>
                                <option
                                    value="A vítima pediu desistência apenas do acompanhamento da Patrulha Maria da Penha">
                                    A vítima pediu desistência apenas do acompanhamento da Patrulha Maria da Penha
                                </option>
                                <option
                                    value="A vítima recusa o acompanhamento da Patrulha Maria da Penha (Em caso de 1º Contato Fiscalizatório)">
                                    A vítima recusa o acompanhamento da Patrulha Maria da Penha (Em caso de 1º Contato
                                    Fiscalizatório)</option>
                                <option value="A vítima retornou a convivência com o seu companheiro.">A vítima retornou
                                    a convivência com o seu companheiro.</option>
                                <option value="Outros">Outros</option>
                            </select>
                        </div>
                        <div class="grupo-input" style="flex:1;">
                            <label>DATA DO ENCERRAMENTO</label>
                            <input type="date" id="DATA_ENCERRAMENTO">
                        </div>
                    </div>

                    <div class="grupo-input">
                        <label>OUTROS</label>
                        <input type="text" id="OUTROS">
                    </div>
                    <div class="grupo-input">
                        <label>JUSTIFICATIVA</label>
                        <textarea name="JUSTIFICATIVA" id="JUSTIFICATIVA"></textarea>
                    </div>
                    <div class="campo" style="flex: 1 1 100%;">
                        <label>Assinatura da Representante:</label>
                        <div style="border: 2px dashed #ccc; background: #fff; position: relative;">
                            <canvas id="ASS_REPRESENTANTE" width="700" height="250"
                                style="cursor: crosshair; width: 100%;"></canvas>
                            <div style="margin-top: 5px;">
                                <button type="button" onclick="limparAssinatura()" class="btn-limpar">Limpar</button>
                                <button type="button" id="btn-travar" onclick="alternarTravaCanvas()"
                                    class="btn-travar">Bloquear Assinatura</button>
                            </div>
                        </div>
                    </div>
                    <div class="campo" style="flex: 1 1 100%;">
                        <label>Assinatura do CMT:</label>
                        <div style="border: 2px dashed #ccc; background: #fff; position: relative;">
                            <canvas id="ASS_CMT" width="700" height="250"
                                style="cursor: crosshair; width: 100%;"></canvas>
                            <div style="margin-top: 5px;">
                                <button type="button" onclick="limparAssinatura_cmt()"
                                    class="btn-limpar">Limpar</button>
                                <button type="button" id="btn-travar_cmt" onclick="alternarTravaCanvas_cmt()"
                                    class="btn-travar">Bloquear Assinatura</button>
                            </div>
                        </div>
                    </div>
                    <div class="campo" style="flex: 1 1 100%;">
                        <label>Assinatura da Testemunha:</label>
                        <div style="border: 2px dashed #ccc; background: #fff; position: relative;">
                            <canvas id="ASS_PM_TESTEMUNHA" width="700" height="250"
                                style="cursor: crosshair; width: 100%;"></canvas>
                            <div style="margin-top: 5px;">
                                <button type="button" onclick="limparAssinatura_testemunha()"
                                    class="btn-limpar">Limpar</button>
                                <button type="button" id="btn-travar_testemunha"
                                    onclick="alternarTravaCanvas_testemunha()" class="btn-travar">Bloquear
                                    Assinatura</button>
                            </div>
                        </div>
                    </div>

                    <div class="botoes-form" style="margin-top: 20px;">
                        <button type="submit" class="btn-salvar" style="width: 100%; padding: 15px; font-weight: bold;">
                            <i class="fas fa-save"></i> SALVAR TERMO DE CONSENTIMENTO
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </section>
    <footer>
        <h4>Seção de Planejamento, Instrução e Estatística - P3/10ºBPM</h4>
        <h4>Patrulha Maria da Penha - 10ºBPM</h4>
    </footer>

    <script>
        // CONFIGURAÇÃO FIREBASE
        const firebaseConfig = {
            databaseURL: "https://botpanico-6346c-default-rtdb.firebaseio.com/"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        // Elementos de Interface
        const sidebar = document.getElementById('sidebarCertidao'); // Ajustado para o ID do seu HTML
        const formCertidao = document.getElementById('formCertidao');

        // --- 1. CONTROLE DA SIDEBAR (Adicionar e Limpar) ---
        function abrirSidebarCertidao() {
            if (sidebar) {
                sidebar.classList.add('active');
                if (formCertidao) formCertidao.reset();

                // Limpa o ID oculto para garantir que seja uma NOVA inserção
                const elId = document.getElementById('id_encerramento');
                if (elId) elId.value = "";

                limparTodosCanvas();
            }
        }

        function fecharSidebarCertidao() {
            if (sidebar) sidebar.classList.remove('active');
        }

        // --- 2. CONFIGURAÇÃO DOS CANVAS (Assinaturas) ---
        const configuracaoCanvas = {
            representante: { id: "ASS_REPRESENTANTE", travado: false, ctx: null },
            cmt: { id: "ASS_CMT", travado: false, ctx: null },
            testemunha: { id: "ASS_PM_TESTEMUNHA", travado: false, ctx: null }
        };

        function inicializarCanvas() {
            Object.keys(configuracaoCanvas).forEach(key => {
                const conf = configuracaoCanvas[key];
                const canvas = document.getElementById(conf.id);
                if (!canvas) return;

                const ctx = canvas.getContext("2d");
                conf.ctx = ctx;
                ctx.lineWidth = 2;
                ctx.lineCap = "round";
                ctx.strokeStyle = "#000";

                let desenhando = false;

                const obterPosicao = (e) => {
                    const rect = canvas.getBoundingClientRect();
                    const clientX = e.touches ? e.touches[0].clientX : e.clientX;
                    const clientY = e.touches ? e.touches[0].clientY : e.clientY;
                    return {
                        x: (clientX - rect.left) * (canvas.width / rect.width),
                        y: (clientY - rect.top) * (canvas.height / rect.height)
                    };
                };

                const iniciar = (e) => {
                    if (conf.travado) return;
                    desenhando = true;
                    const pos = obterPosicao(e);
                    ctx.beginPath();
                    ctx.moveTo(pos.x, pos.y);
                };

                const mover = (e) => {
                    if (!desenhando || conf.travado) return;
                    if (e.cancelable) e.preventDefault();
                    const pos = obterPosicao(e);
                    ctx.lineTo(pos.x, pos.y);
                    ctx.stroke();
                };

                canvas.addEventListener("mousedown", iniciar);
                canvas.addEventListener("mousemove", mover);
                window.addEventListener("mouseup", () => desenhando = false);
                canvas.addEventListener("touchstart", iniciar, { passive: false });
                canvas.addEventListener("touchmove", mover, { passive: false });
            });
        }

        function limparTodosCanvas() {
            Object.values(configuracaoCanvas).forEach(conf => {
                const canvas = document.getElementById(conf.id);
                if (canvas) canvas.getContext("2d").clearRect(0, 0, canvas.width, canvas.height);
            });
        }

        function carregarImagemNoCanvas(canvasId, base64) {
            if (!base64 || base64.length < 100) return; // Evita carregar strings vazias
            const canvas = document.getElementById(canvasId);
            if (!canvas) return;
            const ctx = canvas.getContext("2d");
            const img = new Image();
            img.onload = () => {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                ctx.drawImage(img, 0, 0);
            };
            img.src = base64;
        }

        // --- 3. LOGICA DE DADOS (Firebase) ---

        function formatarDataParaInput(dataBr) {
            if (!dataBr || !dataBr.includes('/')) return dataBr;
            const [dia, mes, ano] = dataBr.split('/');
            return `${ano}-${mes.padStart(2, '0')}-${dia.padStart(2, '0')}`;
        }

        async function popularSelectAssistidas() {
            return new Promise((resolve) => {
                const select = document.getElementById('NOME');
                if (!select) { resolve(); return; }

                db.ref('assistidas').once('value', (snapshot) => {
                    select.innerHTML = '<option value="">Selecione a Assistida...</option>';
                    const assistidas = [];
                    snapshot.forEach((child) => {
                        assistidas.push({ id: child.key, nome: child.val().NOME || "Sem Nome" });
                    });
                    assistidas.sort((a, b) => a.nome.localeCompare(b.nome));
                    assistidas.forEach((a) => {
                        const opt = document.createElement('option');
                        opt.value = a.id;
                        opt.textContent = a.nome;
                        select.appendChild(opt);
                    });
                    resolve();
                });
            });
        }

        function carregarTabela() {
            const tbody = document.getElementById('corpo-tabela-certidoes');
            if (!tbody) return;

            db.ref('assistidas').once('value', (snapAssist) => {
                const assistMap = {};
                snapAssist.forEach(a => { assistMap[a.key] = a.val().NOME; });

                db.ref('encerramento').on('value', (snapshot) => {
                    tbody.innerHTML = "";
                    snapshot.forEach((child) => {
                        const c = child.val();
                        const idRep = c["NOME DA REPESENTANTE"] || c.NOME;
                        const nomeRealRep = assistMap[idRep] || idRep || "-";

                        const tr = document.createElement('tr');
                        tr.innerHTML = `
                            <td>${c.DATA || '-'}</td>
                            <td><b>${nomeRealRep}</b></td>
                            <td>${c.MPU || '-'}</td>
                            <td>${c.NUMERO_BOU || '-'}</td>
                            <td>${c.DATA_ENCERRAMENTO || '-'}</td>
                            <td>${c.MOTIVO_ENCERRAMENTO || '-'}</td>
                            <td>${c.JUSTIFICATIVA || '-'}</td>
                            <td>
                                <button class="btn-edit-tabela" onclick="preencherParaEditar('${child.key}')">
                                    <i class="fas fa-edit"></i>
                                </button>
                            </td>
                        `;
                        tbody.appendChild(tr);
                    });
                });
            });
        }

        async function preencherParaEditar(id) {
            await popularSelectAssistidas();
            db.ref('encerramento').child(id).once('value', (snapshot) => {
                const data = snapshot.val();
                if (!data) return;

                // Abre a sidebar sem resetar o form (para não perder o ID que vamos setar)
                if (sidebar) sidebar.classList.add('active');

                const setVal = (idCampo, valor) => {
                    const el = document.getElementById(idCampo);
                    if (el) el.value = valor || "";
                };

                setVal('id_encerramento', id);
                setVal('NOME', data["NOME DA REPESENTANTE"] || data.NOME);
                setVal('NOME_REPRESENTADO', data.NOME_REPRESENTADO);
                setVal('MPU', data.MPU);
                setVal('VARA', data.VARA);
                setVal('NUMERO_BOU', data.NUMERO_BOU);
                setVal('DATA_ENCERRAMENTO', formatarDataParaInput(data.DATA_ENCERRAMENTO || data.DATA_DE_ENCERRAMENTO));
                setVal('MOTIVO_ENCERRAMENTO', data.MOTIVO_ENCERRAMENTO || data.MOTIVO);
                setVal('JUSTIFICATIVA', data.JUSTIFICATIVA);

                carregarImagemNoCanvas("ASS_REPRESENTANTE", data.ASS_REPRESENTANTE);
                carregarImagemNoCanvas("ASS_CMT", data.ASS_CMT);
                carregarImagemNoCanvas("ASS_PM_TESTEMUNHA", data.ASS_PM_TESTEMUNHA);
            });
        }

        // --- 4. EVENTO DE SALVAR (SUBMIT) ---
        if (formCertidao) {
            formCertidao.addEventListener('submit', (e) => {
                e.preventDefault();

                const idExistente = document.getElementById('id_encerramento').value;
                const idFinal = idExistente || db.ref('encerramento').push().key;

                const dados = {
                    "NOME DA REPESENTANTE": document.getElementById('NOME').value,
                    NOME_REPRESENTADO: document.getElementById('NOME_REPRESENTADO').value,
                    MPU: document.getElementById('MPU').value,
                    VARA: document.getElementById('VARA').value,
                    NUMERO_BOU: document.getElementById('NUMERO_BOU').value,
                    DATA_ENCERRAMENTO: document.getElementById('DATA_ENCERRAMENTO').value,
                    MOTIVO_ENCERRAMENTO: document.getElementById('MOTIVO_ENCERRAMENTO').value,
                    JUSTIFICATIVA: document.getElementById('JUSTIFICATIVA').value,

                    ASS_REPRESENTANTE: document.getElementById("ASS_REPRESENTANTE").toDataURL(),
                    ASS_CMT: document.getElementById("ASS_CMT").toDataURL(),
                    ASS_PM_TESTEMUNHA: document.getElementById("ASS_PM_TESTEMUNHA").toDataURL(),

                    OPERADOR: localStorage.getItem('usuarioNome') || "Operador",
                    UNIDADE: localStorage.getItem('usuarioUnidade') || "PMAL",
                    DATA: new Date().toLocaleDateString('pt-BR')
                };

                db.ref('encerramento').child(idFinal).set(dados).then(() => {
                    alert("Salvo com sucesso!");
                    fecharSidebarCertidao();
                    carregarTabela();
                }).catch(error => alert("Erro ao salvar: " + error));
            });
        }

        // --- FUNÇÕES DO RELATÓRIO MENSAL ---

        function abrirModalRelatorio() {
            const modal = document.getElementById('modal-relatorio');
            if (modal) modal.style.display = 'flex';
        }

        function fecharModalRelatorio() {
            const modal = document.getElementById('modal-relatorio');
            if (modal) modal.style.display = 'none';
        }

        async function gerarRelatorioMensal() {
            const dataInicioStr = document.getElementById('rel-inicio').value;
            const dataFimStr = document.getElementById('rel-fim').value;
            const varaFiltro = document.getElementById('rel-vara').value.toUpperCase();

            if (!dataInicioStr || !dataFimStr) {
                alert("Por favor, selecione o período inicial e final.");
                return;
            }

            // Ajuste para comparação de datas sem erro de fuso horário
            const dInicio = new Date(dataInicioStr + "T00:00:00");
            const dFim = new Date(dataFimStr + "T23:59:59");

            const snapAssist = await db.ref('assistidas').once('value');
            const assistMap = {};
            snapAssist.forEach(a => { assistMap[a.key] = a.val().NOME; });

            db.ref('encerramento').once('value', (snapshot) => {
                const dadosFiltrados = [];

                snapshot.forEach((child) => {
                    const c = child.val();
                    const dataRaw = c.DATA;
                    if (!dataRaw) return;

                    // Converte DATA para comparação (Busca)
                    let dReg;
                    if (dataRaw.includes('-')) {
                        dReg = new Date(dataRaw + "T00:00:00");
                    } else {
                        const [dia, mes, ano] = dataRaw.split('/');
                        dReg = new Date(`${ano}-${mes}-${dia}T00:00:00`);
                    }

                    if (dReg >= dInicio && dReg <= dFim) {
                        const varaReg = (c.VARA || "").toUpperCase();
                        if (!varaFiltro || varaReg.includes(varaFiltro)) {

                            // Tratamento simples para evitar "Invalid Date"
                            let dataEncExibicao = c.DATA_ENCERRAMENTO || "-";
                            if (dataEncExibicao.includes('-')) {
                                const [anoE, mesE, diaE] = dataEncExibicao.split('-');
                                dataEncExibicao = `${diaE}/${mesE}/${anoE}`;
                            }

                            dadosFiltrados.push({
                                dataSolicitada: dReg.toLocaleDateString('pt-BR'),
                                assistida: assistMap[c["NOME DA REPESENTANTE"] || c.NOME] || "Não Identificada",
                                dataEncerramento: dataEncExibicao, // Agora formatada manualmente ou enviada como string
                                mpu: c.MPU || "-",
                                cop: c.NUMERO_BOU || "-",
                                motivo: c.MOTIVO_ENCERRAMENTO || "-",
                                justificativa: c.JUSTIFICATIVA || "-"
                            });
                        }
                    }
                });

                if (dadosFiltrados.length === 0) {
                    alert("Nenhum registro encontrado no período baseado na coluna DATA.");
                    return;
                }

                const relatorioData = {
                    periodo: `${dInicio.toLocaleDateString('pt-BR')} até ${dFim.toLocaleDateString('pt-BR')}`,
                    vara: varaFiltro || "GERAL",
                    unidade: localStorage.getItem('usuarioUnidade') || "PMAL",
                    operador: localStorage.getItem('usuarioNome') || "Sistema ÍRIS",
                    dados: dadosFiltrados
                };

                localStorage.setItem('dadosRelatorioMensal', JSON.stringify(relatorioData));
                window.open('relatorios/relatorio_encerramento_geral.html', '_blank');
                fecharModalRelatorio();
            });
        }
        // --- 5. INICIALIZAÇÃO ---
        function inicializarSistema() {
            const elUnidade = document.getElementById('unidade');
            const elNome = document.getElementById('nome-operador');
            const elRelogio = document.getElementById('current-date-time');

            if (elUnidade) elUnidade.innerText = localStorage.getItem('usuarioUnidade') || "PMAL";
            if (elNome) elNome.innerText = localStorage.getItem('usuarioNome') || "Operador";

            if (elRelogio) {
                setInterval(() => {
                    const agora = new Date();
                    elRelogio.innerText = agora.toLocaleDateString('pt-BR') + " | " + agora.toLocaleTimeString('pt-BR');
                }, 1000);
            }

            inicializarCanvas();
            popularSelectAssistidas();
            carregarTabela();
        }

        window.onload = inicializarSistema;
    </script>
</body>

</html>